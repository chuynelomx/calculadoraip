var app=angular.module("app",["ui.bootstrap"]);app.controller("CalculatorController",["$scope","$uibModal","$log","$document",function(i,e,_,n){var s=this;s.items=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],s.animationsEnabled=!0,s.open=function(_,t){var a=t?angular.element(n[0].querySelector(".modal-demo "+t)):void 0;e.open({animation:s.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"myModalContent.html",controller:"ModalInstanceCtrl",controllerAs:"$ctrl",size:_,appendTo:a,resolve:{items:function(){return s.items}}}).result.then(function(e){s.selected=e,i.generateCIDR(e)},function(){})},i.mask="0",i.base="0",i.ip_1=1,i.ip_2=0,i.ip_3=0,i.ip_4=0,i.ms_1=0,i.ms_2=0,i.ms_3=0,i.ms_4=0,i.ip_1_b="00000000",i.ip_2_b="00000000",i.ip_3_b="00000000",i.ip_4_b="00000000",i.ms_1_b="00000000",i.ms_2_b="00000000",i.ms_3_b="00000000",i.ms_4_b="00000000",i.numRedes=0,i.numHosts=0,i.networkId=0,i.hostId=0,i.data={availableOptions:[{id:"1",name:"Clase A"},{id:"2",name:"Clase B"},{id:"3",name:"Clase C"}],selectedOption:{id:"1",name:"Clase A"}},i.dec2bin=function(i){return(i>>>0).toString(2)},i.bin2dec=function(i){return parseInt(i,2)},i.fixDecimal=function(e,_){var n="0";if(void 0==e)return"0";if(e>255&&0==_||1==i.mask&&e>255)return 255;if(0==i.mask&&1==_){if(1==i.data.selectedOption.id){if(e<1)return 1;if(e>126)return 126}if(2==i.data.selectedOption.id){if(e<128)return 128;if(e>191)return 191}if(3==i.data.selectedOption.id){if(e<192)return 192;if(e>223)return 223}}return n.substring(0,n.length-e.length)+e},i.fixBinary=function(e,_){var n="00000000";if(void 0==e)return n;var s=i.bin2dec(e);return s>255&&0==_||1==i.mask&&s>255?"11111111":(0==i.mask&&1==_&&(1==i.data.selectedOption.id&&(s<1&&(e=i.dec2bin(1)),s>126&&(e=i.dec2bin(126))),2==i.data.selectedOption.id&&(s<128&&(e=i.dec2bin(128)),s>191&&(e=i.dec2bin(191))),3==i.data.selectedOption.id&&(s<192&&(e=i.dec2bin(192)),s>223&&(e=i.dec2bin(223)))),n.substring(0,n.length-e.length)+e)},i.baseChange=function(e){1==e&&(i.ip_1_b=i.fixBinary(i.dec2bin(i.ip_1),!0),i.ip_2_b=i.fixBinary(i.dec2bin(i.ip_2),!1),i.ip_3_b=i.fixBinary(i.dec2bin(i.ip_3),!1),i.ip_4_b=i.fixBinary(i.dec2bin(i.ip_4),!1),i.ms_1_b=i.fixBinary(i.dec2bin(i.ms_1),!1),i.ms_2_b=i.fixBinary(i.dec2bin(i.ms_2),!1),i.ms_3_b=i.fixBinary(i.dec2bin(i.ms_3),!1),i.ms_4_b=i.fixBinary(i.dec2bin(i.ms_4),!1)),0==e&&(i.ip_1=i.bin2dec(i.ip_1_b),i.ip_2=i.bin2dec(i.ip_2_b),i.ip_3=i.bin2dec(i.ip_3_b),i.ip_4=i.bin2dec(i.ip_4_b),i.ms_1=i.bin2dec(i.ms_1_b),i.ms_2=i.bin2dec(i.ms_2_b),i.ms_3=i.bin2dec(i.ms_3_b),i.ms_4=i.bin2dec(i.ms_4_b))},i.selected_class=function(){i.ip_1=i.fixDecimal(i.ip_1,!0),i.ip_1_b=i.fixBinary(i.ip_1_b,!0),1==i.data.selectedOption.id&&(i.ms_4=0,i.ms_4_b="00000000",i.ms_3=0,i.ms_3_b="00000000",i.ms_2=0,i.ms_2_b="00000000",i.ms_1=255,i.ms_1_b="11111111"),2==i.data.selectedOption.id&&(i.ms_4=0,i.ms_4_b="00000000",i.ms_3=0,i.ms_3_b="00000000",i.ms_2=255,i.ms_2_b="11111111",i.ms_1=255,i.ms_1_b="11111111"),3==i.data.selectedOption.id&&(i.ms_4=0,i.ms_4_b="00000000",i.ms_3=255,i.ms_3_b="11111111",i.ms_2=255,i.ms_2_b="11111111",i.ms_1=255,i.ms_1_b="11111111")},i.selected_class(),i.maskChange=function(){0==i.mask&&i.selected_class()},i.blur=function(e){switch(pad="00000000",e){case"ip_1_b":i.ip_1_b=i.fixBinary(i.ip_1_b,!0);break;case"ip_2_b":i.ip_2_b=i.fixBinary(i.ip_2_b,!1);break;case"ip_3_b":i.ip_3_b=i.fixBinary(i.ip_3_b,!1);break;case"ip_4_b":i.ip_4_b=i.fixBinary(i.ip_4_b,!1);break;case"ms_1_b":i.ms_1_b=i.fixBinary(i.ms_1_b,!1);break;case"ms_2_b":i.ms_2_b=i.fixBinary(i.ms_2_b,!1);break;case"ms_3_b":i.ms_3_b=i.fixBinary(i.ms_3_b,!1);break;case"ms_4_b":i.ms_4_b=i.fixBinary(i.ms_4_b,!1)}},i.blur_d=function(e){switch(e){case"ip_1":i.ip_1=i.fixDecimal(i.ip_1,!0);break;case"ip_2":i.ip_2=i.fixDecimal(i.ip_2,!1);break;case"ip_3":i.ip_3=i.fixDecimal(i.ip_3,!1);break;case"ip_4":i.ip_4=i.fixDecimal(i.ip_4,!1);break;case"ms_1":i.ms_1=i.fixDecimal(i.ms_1,!1);break;case"ms_2":i.ms_2=i.fixDecimal(i.ms_2,!1);break;case"ms_3":i.ms_3=i.fixDecimal(i.ms_3,!1);break;case"ms_4":i.ms_4=i.fixDecimal(i.ms_4,!1)}},i.getBinaries=function(){i.ip_1_b=i.fixBinary(i.dec2bin(i.ip_1),!0),i.ip_2_b=i.fixBinary(i.dec2bin(i.ip_2),!1),i.ip_3_b=i.fixBinary(i.dec2bin(i.ip_3),!1),i.ip_4_b=i.fixBinary(i.dec2bin(i.ip_4),!1),i.ms_1_b=i.fixBinary(i.dec2bin(i.ms_1),!1),i.ms_2_b=i.fixBinary(i.dec2bin(i.ms_2),!1),i.ms_3_b=i.fixBinary(i.dec2bin(i.ms_3),!1),i.ms_4_b=i.fixBinary(i.dec2bin(i.ms_4),!1)},i.getDecimals=function(){i.ip_1=i.bin2dec(i.ip_1_b),i.ip_2=i.bin2dec(i.ip_2_b),i.ip_3=i.bin2dec(i.ip_3_b),i.ip_4=i.bin2dec(i.ip_4_b),i.ms_1=i.bin2dec(i.ms_1_b),i.ms_2=i.bin2dec(i.ms_2_b),i.ms_3=i.bin2dec(i.ms_3_b),i.ms_4=i.bin2dec(i.ms_4_b)},i.calculate=function(){0==i.base&&i.getBinaries(),1==i.base&&i.getDecimals();for(var e=0,_=!0,n=0,s=i.ms_1_b+i.ms_2_b+i.ms_3_b+i.ms_4_b,t=0,a=s.length;t<a;t++)0==e&&"0"==s[t]&&(e=1),1==e&&"1"==s[t]&&(_=!1),"1"==s[t]&&n++;if(!_)return void alert("La máscara de subred no es válida");var b=32-n;if(0==i.mask&&(1==i.data.selectedOption.id&&(i.numRedes=Math.pow(2,7),i.numHosts=Math.pow(2,24)-2),2==i.data.selectedOption.id&&(i.numRedes=Math.pow(2,14),i.numHosts=Math.pow(2,16)-2),3==i.data.selectedOption.id&&(i.numRedes=Math.pow(2,21),i.numHosts=Math.pow(2,8)-2)),1==i.mask)if(i.numHosts=Math.pow(2,b),n>24){var c=n-24;i.numRedes="1/"+Math.pow(2,c)}else{var c=24-n;i.numRedes=Math.pow(2,c)}for(var m="",r="",d="",o="",l="",p="",u="",f="",t=0,a=8;t<a;t++)"1"==i.ms_1_b[t]?(l+=i.ip_1_b[t],m+="0"):(l+="0",m+=i.ip_1_b[t]),"1"==i.ms_2_b[t]?(p+=i.ip_2_b[t],r+="0"):(p+="0",r+=i.ip_2_b[t]),"1"==i.ms_3_b[t]?(u+=i.ip_3_b[t],d+="0"):(u+="0",d+=i.ip_3_b[t]),"1"==i.ms_4_b[t]?(f+=i.ip_4_b[t],o+="0"):(f+="0",o+=i.ip_4_b[t]);i.networkId=i.bin2dec(l)+"."+i.bin2dec(p)+"."+i.bin2dec(u)+"."+i.bin2dec(f),i.hostId=i.bin2dec(m)+"."+i.bin2dec(r)+"."+i.bin2dec(d)+"."+i.bin2dec(o)},i.generateCIDR=function(e){i.ms_1_b="",i.ms_2_b="",i.ms_3_b="",i.ms_4_b="";for(var _=0;_<8;_++)0!=e?(i.ms_1_b+="1",e--):i.ms_1_b+="0";for(var _=0;_<8;_++)0!=e?(i.ms_2_b+="1",e--):i.ms_2_b+="0";for(var _=0;_<8;_++)0!=e?(i.ms_3_b+="1",e--):i.ms_3_b+="0";for(var _=0;_<8;_++)0!=e?(i.ms_4_b+="1",e--):i.ms_4_b+="0"}}]),app.directive("limitTo",[function(){return{restrict:"A",link:function(i,e,_){var n=parseInt(_.limitTo);angular.element(e).on("keypress",function(i){0==this.selectionStart&&8==this.selectionEnd&&(this.value=""),0==this.selectionStart&&3==this.selectionEnd&&(this.value=""),this.value.length==n&&i.preventDefault()})}}}]),app.directive("numbersOnly",function(){return{require:"ngModel",link:function(i,e,_,n){function s(i){if(i){var e=i.replace(/[^0-9]/g,"");return e!==i&&(n.$setViewValue(e),n.$render()),e}}n.$parsers.push(s)}}}),app.directive("binaryOnly",function(){return{require:"ngModel",link:function(i,e,_,n){function s(i){if(i){var e=i.replace(/[^0-1]/g,"");return e!==i&&(n.$setViewValue(e),n.$render()),e}}n.$parsers.push(s)}}}),app.directive("selectOnClick",["$window",function(i){return{restrict:"A",link:function(e,_,n){_.on("click",function(){i.getSelection().toString()||this.setSelectionRange(0,this.value.length)})}}}]),app.controller("ModalInstanceCtrl",function(i,e){var _=this;_.items=e,_.selected={item:_.items[0]},_.ok=function(e){_.selected.item=e,i.close(_.selected.item)},_.cancel=function(){i.dismiss("cancel")}}),app.component("modalComponent",{templateUrl:"myModalContent.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:function(){var i=this;i.$onInit=function(){i.items=i.resolve.items,i.selected={item:i.items[0]}},i.ok=function(){i.close({$value:i.selected.item})},i.cancel=function(){i.dismiss({$value:"cancel"})}}});